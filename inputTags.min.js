/**
 @ Name：输入框标签
 @ Author：Jioho
 */
class inputTags{constructor(config={}){var tmp_content=config.content?new Set(config.content):[];return this.content=[...tmp_content],this.theme=config.theme||"#1e9fff",this.elem=config.elem,this.inputType=config.inputType||"text",this.placeholder=config.placeholder||"回车生成标签",this.regular=config.regular||{},this.beforeEnter=config.beforeEnter,this.afterEnter=config.afterEnter,this.proxy={},this.init(),this}on(event,callback){this.proxy[event]=callback}getTagsHtml(content){return"<div class='inputTags--tag' style='background:"+this.theme+";'><span>"+content+"</span><span class='icon'>×</span></div>"}init(){var self=this,inputTags_input="<input class='inputTags--input' type='"+self.inputType+"' placeholder='"+self.placeholder+"' autocomplete='off'>",tags_html="";$(self.elem+" .inputTags--tag").css("background","#FFB800"),$(self.elem).addClass("inputTags--container").html(inputTags_input),self.content.forEach((v,k)=>{tags_html+=self.getTagsHtml(v)}),$(self.elem+" input").before(tags_html),self.bindEvent(),self.bindDelTag()}bindEvent(){var self=this;$(self.elem+" input").keypress(function(e){var keynum;if("13"==(e.keyCode?e.keyCode:e.which)){if(self.beforeEnter&&0==self.beforeEnter())return!1;var input_obj=this,input_value=$(this).val().trim(),test_result=self.regular.rule&&self.verification(input_value);if(!test_result)return test_result;self.render([input_value]),self.afterEnter&&self.afterEnter(self.content)}})}render(tag_text_array){var self=this;tag_text_array.forEach((v,k)=>{""!=v&&-1==self.content.indexOf(v)&&($(self.elem+" input").before(self.getTagsHtml(v)),self.content.push(v))}),$(self.elem+" input").val("")}bindDelTag(){var self=this;$(self.elem).on("click",".inputTags--tag",function(obj){self.delTag(this)})}delTag(obj){var self=this,del_text=$(obj).find("span").text(),del_index=this.content.indexOf(del_text);this.content.splice(del_index,1),$(obj).remove(),this.proxy.delTag&&this.proxy.delTag(this.content)}clearAll(){this.content=[],$(this.elem+" .inputTags--tag").remove()}reload(conetnt){var tmp_content=conetnt?new Set(conetnt):[];this.clearAll(),this.render([...tmp_content])}getValue(){return this.content}verification(value){var self=this,test_resule=!1,rule=this.regular.rule;return"string"!=typeof rule||(rule=regular_list.getResular(rule))?(rule.test?rule.test(value)?test_resule=!0:this.regular.err_callback&&this.regular.err_callback({code:1,msg:"未通过正则验证"}):this.regular.err_callback&&this.regular.err_callback({code:2,msg:"正则表达式有误"}),test_resule):(this.regular.err_callback&&this.regular.err_callback({code:2,msg:"正则表达式有误"}),!1)}}var regular_list={mobile:/^1[3|4|5|7|8]\d{9}$/,email:/^[A-Za-z0-9._%-]+@([A-Za-z0-9-]+\.)+[A-Za-z]{2,4}$/,no_chinese:/^[A-Za-z0-9]{4,40}$/,getResular:function(key){return!!this[key]&&this[key]}};